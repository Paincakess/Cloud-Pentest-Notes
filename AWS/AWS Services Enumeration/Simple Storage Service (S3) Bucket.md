---
title: Simple Storage Service (S3) Bucket
updated: 2022-12-27 09:46:44Z
created: 2022-12-27 07:22:13Z
latitude: 27.71724530
longitude: 85.32396050
altitude: 0.0000
---

Amazon S3 is a service that allows you store big amounts of data.

## Bucket Enumeration
- List s3 buckets 
	- `aws s3 ls`
	- `aws s3api list-buckets`

## Bucket Content
- List bucket content
	- `aws s3 ls s3://<bucket_name>`
- Object version
	- `aws s3api list-objects-v2 --bucket <bucket-name>`
	- `aws s3api list-objects --bucket <bucket-name>`
	- `aws s3api list-object-versions --bucket <bucket-name>`
- List buckets without creds
	- `aws s3 ls s3://bucket-name --no-sign-request`
- Download file from Bucket
	- `aws s3 cp MyFolder s3://bucket-name --recursive`
- Delete Files from Bucket
	- `aws s3 rb s3://bucket-name â€“-force`
- Download a whole s3 bucket content
	- `aws s3 sync s3://<bucket>/ .`
- List the sizes of an S3 bucket and its contents
	- `aws s3api list-objects --bucket BUCKETNAME --output json --query "[sum(Contents[].Size), length(Contents[])]"`

## Bucket Policy
- Update Bucket Policy
	- `aws s3api put-bucket-policy --policy file:///root/policy.json --bucket <bucket-name>`
- JSON Policy example
```
{
  "Id": "Policy1568185116930",
  "Version": "2022-12-11",
  "Statement": [
  {
      "Sid": "Stmt1568109932241",
      "Action": [
        "s3:ListBucket"
      ],
      "Effect": "Allow",
      "Resource": "arn:aws:s3:::onion",
      "Principal": "*"
  },
  {
    "Sid": "Stmt1568185007451",
    "Action": [
      "s3:GetObject"
    ],
    "Effect": "Allow",
    "Resource": "arn:aws:s3:::onion/*",
    "Principal": "*"
  }
  ]
}
```

## Bucket ACL
- Get Bucket ACL
	- `aws s3api get-bucket-acl --bucket <bucket_name>`
- Update Bucket ACL
	- `aws s3api put-bucket-acl --bucket <bucket_name> --access-control-policy file://acl.json`
	- JSON ACL example
```
{
  "Owner": {
    "DisplayName": "<DisplayName>",
    "ID": "<ID>"
  },
  "Grants": [
  {
    "Grantee": {
      "Type": "Group",
      "URI": "http://acs.amazonaws.com/groups/global/AuthenticatedUsers"
    },
  "Permission": "FULL_CONTROL"
  }
  ]
}
```
