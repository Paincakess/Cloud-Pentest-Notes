---
title: Lambda
updated: 2022-12-31 06:42:09Z
created: 2022-12-31 06:19:59Z
latitude: 27.71724530
longitude: 85.32396050
altitude: 0.0000
---

Lambda is a compute service that lets you run code without provisioning or managing servers.
## Account Settings
- Get Account Settings
	- `aws lambda get-account-settings`

## Functions and Config Enumeration
- List Functions
	- `aws lambda list-functions`
- Get Environment variables of function
	- `aws lambda list-functions | jq '.Functions[].Environment'`
- Get Function invoke configs
	- `aws lambda list-function-event-invoke-configs --function-name <function_name>`
- Get Function's URL Config
	- `aws lambda list-function-url-configs --function-name <function_name>`
- Get Configuration of a Function
	- `aws lambda get-function-configuration --function-name <function_name>`
- Get Function's Policy
	- `aws lambda get-policy --function-name <function_name>`
- List Function with its version
	- `aws lambda list-versions-by-function --function-name <function_name>`
- List Aliases of the Function
	- `aws lambda list-aliases --function-name <function_name>`
- Get More information about the Function and address to download the code
	- `aws lambda get-function --function-name <function_name>`
- Code to Download Function
	```
	aws lambda get-function --function-name <function_name> --query 'Code.Location' --profile <profile>
	wget -O lambda-function.zip url-from-previous-query
	```
	
## Layer Enumeration
- List layers
	- `aws lambda list-layers`
- List Version of the layer
	- `aws lambda list-layer-versions --layer-name <layer_name>`
- Enumerate layer's previous versions
	- `aws lambda get-layer-version --layer-name <layer_ name> --version-number <version>`

## Invoke Functions
- Invoke a Function
	- `aws lambda invoke --function-name <function_name> /tmp/out`

## Metadata Informations
- List Event Source Mapping
	- `aws lambda list-code-signing-configs`
- List Code Signings Configs
	- `aws lambda list-code-signing-configs`
- List Functions with specific code signing
	- `aws lambda list-functions-by-code-signing-config --code-signing-config-arn <arn>`

# Vulnerabilties
## Version Backdoor + API Gateway
- Copy the original code of the Lambda
- Create a new version backdooring the original code (or just with malicious code). Publish and deploy that version to $LATEST
	- Call the API gateway related to the lambda to execute the code
- Create a new version with the original code, Publish and deploy that version to $LATEST.
	- This will hide the backdoored code in a previous version
- Go to the API Gateway and create a new POST method (or choose any other method) that will execute the backdoored version of the lambda: `arn:aws:lambda:us-east-1:<acc_id>:function:<func_name>:1`
	- Note the `final :1` of the arn indicating the version of the function
- Select the POST method created and in Actions select Deploy API
- Now, when you call the function via POST your Backdoor will be invoked